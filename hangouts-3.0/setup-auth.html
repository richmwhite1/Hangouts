<!DOCTYPE html>
<html>
<head>
    <title>Setup Authentication</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #1a1a1a; color: white; }
        .container { max-width: 600px; margin: 0 auto; }
        .debug { background: #333; padding: 15px; margin: 10px 0; border-radius: 8px; }
        button { background: #4299e1; color: white; padding: 12px 24px; border: none; border-radius: 6px; cursor: pointer; margin: 5px; }
        button:hover { background: #3182ce; }
        .success { background: #48bb78; color: white; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .error { background: #f56565; color: white; padding: 10px; margin: 10px 0; border-radius: 5px; }
        pre { background: #1a202c; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîê Setup Authentication for Hangouts</h1>
        
        <div class="debug">
            <h3>Current Authentication Status</h3>
            <div id="authStatus"></div>
        </div>

        <div class="debug">
            <h3>Actions</h3>
            <button onclick="setAuth()">Set Authentication</button>
            <button onclick="clearAuth()">Clear Authentication</button>
            <button onclick="testAuth()">Test Authentication</button>
            <button onclick="goToHangout()">Go to Hangout Page</button>
        </div>

        <div class="debug">
            <h3>Test Results</h3>
            <div id="testResults"></div>
        </div>
    </div>

    <script>
        const JWT_SECRET = 'your-super-secret-jwt-key-here-make-it-long-and-random';
        const hangoutId = 'hangout_1758565278199_adqpwjcwh';
        
        function setAuth() {
            const testUser = {
                id: 'cmfvgcfli0000jphd45q3zadx',
                email: 'test@example.com',
                username: 'testuser',
                name: 'Test User'
            };
            
            const token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJjbWZ2Z2NmbGkwMDAwanBoZDQ1cTN6YWR4IiwiZW1haWwiOiJ0ZXN0QGV4YW1wbGUuY29tIiwidXNlcm5hbWUiOiJ0ZXN0dXNlciIsImlhdCI6MTc1ODU2NTI4MiwiZXhwIjoxNzU5MTcwMDgyfQ.NDVcQMwRUT6JHnHtDgQZ9fxcmzNMYHGO5oxxvofH4xE';
            
            localStorage.setItem('auth_token', token);
            localStorage.setItem('auth_user', JSON.stringify(testUser));
            
            updateAuthStatus();
            document.getElementById('testResults').innerHTML = '<div class="success">‚úÖ Authentication set successfully!</div>';
        }
        
        function clearAuth() {
            localStorage.removeItem('auth_token');
            localStorage.removeItem('auth_user');
            updateAuthStatus();
            document.getElementById('testResults').innerHTML = '<div class="error">‚ùå Authentication cleared</div>';
        }
        
        function updateAuthStatus() {
            const token = localStorage.getItem('auth_token');
            const user = localStorage.getItem('auth_user');
            
            if (token && user) {
                try {
                    const userObj = JSON.parse(user);
                    document.getElementById('authStatus').innerHTML = `
                        <div class="success">‚úÖ Authenticated</div>
                        <div>User: ${userObj.name} (${userObj.username})</div>
                        <div>Email: ${userObj.email}</div>
                        <div>Token: ${token.substring(0, 20)}...</div>
                    `;
                } catch (e) {
                    document.getElementById('authStatus').innerHTML = '<div class="error">‚ùå Invalid user data</div>';
                }
            } else {
                document.getElementById('authStatus').innerHTML = '<div class="error">‚ùå Not authenticated</div>';
            }
        }
        
        async function testAuth() {
            const token = localStorage.getItem('auth_token');
            if (!token) {
                document.getElementById('testResults').innerHTML = '<div class="error">‚ùå No token found</div>';
                return;
            }
            
            try {
                // Test hangout API
                const hangoutResponse = await fetch(`http://localhost:3000/api/hangouts/${hangoutId}`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                // Test polls API
                const pollsResponse = await fetch(`http://localhost:3000/api/hangouts/${hangoutId}/polls-simple`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                
                const hangoutData = await hangoutResponse.json();
                const pollsData = await pollsResponse.json();
                
                document.getElementById('testResults').innerHTML = `
                    <div class="success">‚úÖ API Tests Successful</div>
                    <div>Hangout API: ${hangoutResponse.status} ${hangoutResponse.ok ? 'OK' : 'Error'}</div>
                    <div>Polls API: ${pollsResponse.status} ${pollsResponse.ok ? 'OK' : 'Error'}</div>
                    <div>Hangout: ${hangoutData.hangout?.title || hangoutData.title || 'Unknown'}</div>
                    <div>Polls: ${pollsData.polls?.length || 0} polls found</div>
                    <div>Raw hangout data: <pre>${JSON.stringify(hangoutData, null, 2)}</pre></div>
                    <div>Raw polls data: <pre>${JSON.stringify(pollsData, null, 2)}</pre></div>
                `;
            } catch (error) {
                document.getElementById('testResults').innerHTML = `<div class="error">‚ùå API Test Error: ${error.message}</div>`;
            }
        }
        
        function goToHangout() {
            window.location.href = `http://localhost:3000/hangouts/${hangoutId}`;
        }
        
        // Update status on load
        window.onload = function() {
            updateAuthStatus();
        };
    </script>
</body>
</html>


























